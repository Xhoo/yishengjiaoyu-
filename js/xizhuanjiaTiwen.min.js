$(function() {
	//需要参数  localhost() 
//		var preUrl="http://47.90.85.71/yishengjiaoyu/xiZhuanTiwen.html?userUrl=http://k1602677i8.iok.la/image/14800663455190a0953dd05334c1483a18d40d03a5ac8.jpg&userName=%E5%A4%A7%E5%A4%A7%20%E7%9A%84%E6%92%92%3E&specialistMoney=99.8&zhiwei=%E6%9C%80%E5%BC%BA%E7%8E%8B%E8%80%85&jiao=%E6%95%99&zhuan=%E4%B8%93"
		var preUrl=window.location.href;
		//window.location.href;
		var splitUrl=getUrl(decodeURI(preUrl));
		var shujuall={
			id:splitUrl.identity
		}
		$.ajax({
				url: localhost() + "user/get_user_details?identity="+shujuall.id,
				dataType: "json",
				async: true,
//				data: JSON.stringify(data),
				type: "GET",
//				contentType: "application/json",
				beforeSend: function() {
					console.log("======== 请求之前调用11111 =========")
				},
				success: function(shuju) {
				if(shuju.code==1002){window.location.href=locationHref()+'yishengjiaoyu/login';}
				console.log("========= 服务器响应成功调用111111 ==========");
				console.log(shuju.data.userSpecialistDetails.teacherType);
				if(shuju.data.userSpecialistDetails.teacherType == "教") {
				if(shuju.data.userSpecialistDetails.userType == "专") {
					$("<img src='img/ic_zhuan_jiao.png'>").appendTo(".content-img")
				} else {
					
					$("<img src='img/ic_jiao.png'>").appendTo(".content-img")
				}
				} else {
					if(shuju.data.userSpecialistDetails.userType == "专") {
						$("<img src='img/ic_zhuan.png'>").appendTo(".content-img")
					} else {
						$(".content-img").hide()
					}
				}
			
//			$(".oTextarea textarea").on('keypress', function(){
//		      var oTextLength = $(this).val().length; 
//		      $(".oTextarea textarea span").html(oTextLength)
//			});
		$("<img src="+shuju.data.userSpecialistDetails.userUrl+">").appendTo($(".content-msg>span"));
		$(".content-name").html(shuju.data.userSpecialistDetails.userName);
		$(".content-zhiwu").html(shuju.data.userSpecialistDetails.specialistJobtitle);
		$(".div-input input").val("立即提问（支付￥"+shuju.data.userSpecialistDetails.specialistMoney+"元）")
				},
				error: function() {
					console.log("======= 服务器响应失败调用111 ==========")
				},
				complete: function() {
					console.log("======== 111111请求完毕之后调用，注意：无论服务器响应成功与否，都会调用这个函数！！ ===========")
				}
			})
		
		$(".div-input").on("touchstart","input",function() {
		var textareaContent = $(".oTextarea textarea").val();
//		console.log(textareaContent);
		var data = {};
		var arr=[];
		data.problemTitle = textareaContent;
		data.problemContent = textareaContent;
		data.problemLevel = "qweqeqeqweq";
		data.problemSubject = "qweqeqeqweq";
		data.integral = 20;
	
		data.assignSpecialistId = 10;
		data.assignMoney = 189;
		data.type = "1";
		console.log(data);
//		var url = localhost() + "problem/add_problem";
		$(".div-input input").on("touchstart",function(){
			arr.push($(".t-ptw_list li img").attr("src"));
			data.problemImage = arr;
			ajax(data)
		})
		function ajax() {

			$.ajax({
				url: localhost() + "problem/add_problem",
				dataType: "json",
				async: true,
				data: JSON.stringify(data),
				type: "POST",
				contentType: "application/json",
				beforeSend: function() {
					console.log("======== 请求之前调用11111 =========")
				},
				success: function(shuju) {
					if(shuju.code==1002){window.location.href=locationHref()+'yishengjiaoyu/login';}
					console.log("========= 服务器响应成功调用111111 ==========");
					console.log(shuju);
					var urls = "yishengjiaoyu/html/qzindex.html";
					getPath(urls);
				},
				error: function() {
					console.log("======= 服务器响应失败调用111 ==========")
				},
				complete: function() {
					console.log("======== 111111请求完毕之后调用，注意：无论服务器响应成功与否，都会调用这个函数！！ ===========")
				}
			})
		}
	});
	
	
	
//	$(".header-right").on("touchstart",function(){
//		$(".tanchu").toggle()
//	});
	$(".header-left").on("touchstart",function(){
		window.history.back(-1); 
	});
	$(".tanchu p:nth-of-type(1)").on("touchstart",function(){
		var urls="yishengjiaoyu/wodetiwen.html?otype=0&timestamp="+timestamp;
	getPath(urls);
	})
	$(".tanchu p:nth-of-type(2)").on("touchstart",function(){
		var urls="yishengjiaoyu/wodetiwen.html?otype=1&timestamp="+timestamp;
	getPath(urls);
	});
	
});