var shuju = {};
shuju.type = 1;
shuju.integral = 0;
var arr = [];
//需要参数  localhost() 
var preUrl = window.location.href;
var splitUrl = getUrl(preUrl);
//	console.log(splitUrl)
var id = splitUrl.id;
var ddd = splitUrl.type;
var timestamp = new Date().getTime();
$(".header-left").on("touchstart", function() {
	if(ddd == 0) {
		var urls = "yishengjiaoyu/html/qzindex.html";
		getPath(urls);
	} else if(ddd == 1) {
		window.history.go(-1);
	}

});
$("#text").on("focus", function() {
	$("#text").css({
		"borderColor": "#CCC"
	})
});
$(".jifen p:nth-of-type(2) input").on("touchstart", function() {
	$(".jifen p:nth-of-type(2) input").attr("class", "");
	$(".jifen input[type=text]").attr("disabled", "disabled");
	shuju.integral = $(this).attr("class", "inputActive").val();
	console.log(shuju.integral);
	if($(this).val() == "其他") {
		$(".jifen input[type=text]").removeAttr("disabled");
		console.log(shuju.integral)
	} else if($(this).val() == "无") {
		$(".jifen input[type='text']").val("");
		$(".jifen input[type=text]").attr("disabled", "disabled");
		$("#text").css({
			"borderColor": "#CCC"
		});
		shuju.integral = 0
	} else {
		$(".jifen input[type='text']").val("");
		shuju.integral = parseInt($(this).val());
		$("#text").css({
			"borderColor": "#CCC"
		})
	}
});
//console.log(shuju.integral);

function tishi(value) {
	//	console.log($("#text"))
	$("#text").css({
			"borderColor": "#f93a3a"
		})
		//	console.log($("#text").css())
		//	console.log($(".erra"));
	$(".erra").html(value);
	$(".erra").fadeIn(300, function() {
		setTimeout(function() {
			$(".erra").fadeOut()
		}, 500)
	})
}
$(".button section:nth-of-type(1) input").on("touchstart", function() {
	var urls = "yishengjiaoyu/zhuanjiaIndex.html?type=1&timestamp="+ timestamp;
	getPath(urls);
});
$(".button section:nth-of-type(2) input").on("touchstart", function() {
	var urls = "lifetime/yishengjiaoyu/html/teacher.html?type=1&timestamp="+ timestamp;
	getPath(urls);
	//http://k1602677i8.iok.la/lifetime/yishengjiaoyu/html/teacher.html
});
function ajax(shuju) {

	function JTrim(s) {
		return s.replace(/(^\s*)|(\s*$)/g, "");
	}

	　　
	var userName = shuju.problemTitle;　　
	if(JTrim(userName) != "")　　 {　　
		$.ajax({
			url: localhost() + "problem/add_problem",
			dataType: "json",
			async: true,
			data: JSON.stringify(shuju),
			type: "POST",
			contentType: "application/json",
			beforeSend: function() {
				console.log(arr);
				console.log("======== 请求之前调用 =========")
			},
			success: function(data) {

				console.log("========= 服务器响应成功调用 ==========");
				console.log(data)
					//			var code=data.code;
				if(shuju.code == 1002) {
					window.location.href = locationHref() + 'yishengjiaoyu/login';
				}

				var urls = "yishengjiaoyu/wodetiwen.html?otype=1&type=1&timestamp=" + timestamp;
				getPath(urls);
				
			},
			error: function() {
				console.log("======= 服务器响应失败调用 ==========")
			},
			complete: function() {
				console.log("======== 请求完毕之后调用，注意：无论服务器响应成功与否，都会调用这个函数！！ ===========")
			}
		})　　
	} else {
		console.log("请输入数据")
	}

	//	console.log(shuju);

};
$(".header-right").on("touchstart", function() {
	shuju.problemTitle = $("textarea[name='questionTitle']").val();
	shuju.problemContent = $("textarea[name='questionDetail']").val();
	shuju.problemLevel = $(".questionType>span:nth-of-type(2) span:nth-of-type(2)").text();
	shuju.problemSubject = $(".questionType>span:nth-of-type(2) span:nth-of-type(1)").text();
	console.log(shuju.problemImage);
	console.log(shuju.problemTitle);
	console.log(shuju.problemContent);
	console.log(shuju.problemLevel);
	console.log(shuju.problemSubject);
	console.log(shuju.problemImage);
	if($("#text").val()) {
		var reg = /^\+?[1-9][0-9]*$/;
		if(reg.test($("#text").val())) {
			shuju.integral = parseInt($("#text").val());
			ajax(shuju)
		} else {
			tishi("输入有误！")
		}
	} else {
		arr.push($(".t-ptw_list li img").attr("src"))
		shuju.problemImage = arr;
		console.log(shuju.problemImage);
		ajax(shuju)
	}
});


$("#text").on("focus", function() {
	var h = document.body.clientHeight;
	var hRem = h / 20;
	//		console.log(hRem);
	if(hRem >= 82) {
		$("body").css("marginBottom", "33.5rem")
	}
})
$("#text").on("blur", function() {
	var h = document.body.clientHeight;
	var hRem = h / 20;
	//		console.log(hRem);
	if(hRem <= 82) {
		$("body").css("marginBottom", "0")
	}
})

