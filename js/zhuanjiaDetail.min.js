$(function() {
	$(".tab2 p:nth-of-type(1)").on("touchstart", function() {
		$(".pinglun").css({
			"display": "none"
		});
		$(".tab2 p").css({
			"fontWeight": "100"
		});
		$(".detail").css({
			"display": "block"
		});
		$(".tab2 p:nth-of-type(1)").css({
			"fontWeight": "bold"
		})
	});
	$(".tab2 p:nth-of-type(2)").on("touchstart", function() {
		$(".detail").css({
			"display": "none"
		});
		$(".tab2 p").css({
			"fontWeight": "100"
		});
		$(".pinglun").css({
			"display": "block"
		});
		$(".tab2 p:nth-of-type(2)").css({
			"fontWeight": "bold"
		})
	});
	//var urls=需要跳转到的页面
	var preUrl = window.location.href;
	var splitUrl = getUrl(preUrl);
	console.log(splitUrl)
	var identity = splitUrl.identity;
	var ddd = splitUrl.type
	$(".header-left").on("touchstart", function() {
		if(ddd == 0) {
			var urls = "yishengjiaoyu/html/qzindex.html";
			getPath(urls);
		} else if(ddd == 1) {
			window.history.go(-1);
		}
	});
	$.ajax({
		url: localhost() + "user/get_user_details?identity=" + identity,
		dataType: "json",
		async: true,
		type: "GET",
		beforeSend: function() {
			console.log("======== 请求之前调用 =========")
		},
		success: function(shuju) {
			console.log("========= 服务器响应成功调用22222 ==========");
			if(shuju.code == 10002) {
				window.location.href = locationHref() + 'yishengjiaoyu/login';
			}
//			$(".header-center").html(shuju.data.userSpecialistDetails.userName);
			$(".photo-name").html(shuju.data.userSpecialistDetails.userName);
			$(".photo-top-img").append("<img src=" + shuju.data.userSpecialistDetails.userUrl + ">");
			$(".photo-erweima").append("<img src=" + shuju.data.userSpecialistDetails.userQrCode + ">");
			$(".tab2 p:nth-of-type(1) span").html(shuju.data.userSpecialistDetails.answerTotal);
			$(".tab2 p:nth-of-type(2) span").html(shuju.data.commentTotal);
			$(".photo-jiaoshi1").html(shuju.data.userSpecialistDetails.specialistJobtitle)
			if(shuju.data.userSpecialistDetails.userSex) {
				var img1 = document.createElement("img");
				img1.src = "./img/ic_man.png";
				$(".photo-sex").append(img1)
			} else {
				var img1 = document.createElement("img");
				img1.src = "./img/sex-w.png";
				$(".photo-sex").append(img1)
			}
			if(shuju.data.userSpecialistDetails.teacherType == "教") {
				if(shuju.data.userSpecialistDetails.userType == "专") {
					$("<img src='img/ic_zhuan_jiao.png'>").appendTo(".ptoto-zhiwei")
				} else {
					$("<img src='img/ic_jiao.png'>").appendTo(".ptoto-zhiwei")
				}
			} else {
				if(shuju.data.userSpecialistDetails.userType == "专") {
					$("<img src='img/ic_zhuan.png'>").appendTo(".ptoto-zhiwei")
				} else {
					$(".ptoto-zhiwei").remove()
				}
			}
			if(shuju.data.userSpecialistDetails.specialistQualificationsStatus == 1) {
				$(".text-div1 img").attr("src", "./img/ic_attestation_blue.png")
			} else {
				$(".text-div1 img").attr("src", "./img/ic_attestation_black.png")

			}
			if(shuju.data.userSpecialistDetails.specialistIdentityStatus == 1) {
				$(".text-div2 img").attr("src", "./img/ic_attestation_blue.png")

			} else {
				$(".text-div2 img").attr("src", "./img/ic_attestation_black.png")
			}
			if(shuju.data.userSpecialistDetails.collection == 0) {
				$("#sixin").addClass("btntxt2");
				$("#sixin").val("关注");

			} else {
				$("#sixin").addClass("btntxt1");
				$("#sixin").val("私信");

			}
			for(var value of shuju.data.problemAnswer) {
				if(value.like) {
					zanImg = "./img/ic_up_blue.png"
				} else {
					zanImg = "./img/zan.gif"
				}
				$("<li><section class='section1'>" + value.problemTitle + "</section><section class='section3'><span class=''></span><span id='voice1' class='video'></span><span class=''>" + value.acceptionAudios + "</span></section><section class='section4'><span class=''></span><span class=''></span><span class=''></span><span class=''><img src=" + zanImg + "/><span>" + value.likeTotal + "</span></span><span class=''>" + value.orderTotal + "人听过</span></section></li>").appendTo(".detail");
				$(function(url) {
					$("#voice1").audio5js({
						url: "yinpin/demo.mp3"
					})
				})
			}
			for(var value of shuju.data.commentList) {
				var date = new Date(value.time);
				Y = date.getFullYear() + '-';
				M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
				D = date.getDate() + ' ';
				h = date.getHours() + ':';
				m = date.getMinutes() + ':';
				s = date.getSeconds();
				$("<li><section><img src=" + value.userModel.userUrl + "><div class='pinglun-right'><ul><li>" + value.userModel.userName + "</li><li><ol class='pingfenOl'><span>总体</span><li><img src='img/ic_collect_black.png'/></li><li><img src='img/ic_collect_black.png'/></li><li><img src='img/ic_collect_black.png'/></li><li><img src='img/ic_collect_black.png'/></li><li><img src='img/ic_collect_black.png'/></li></ol></li></ul></div></section><section><p>" + value.commentContent + "</p><span class=''>" + Y + M + D + h + m + s + "</span></section></li>").appendTo(".pinglun");
				var arr = [];
				for(var i = 1; i <= value.score; i += 1) {
					arr.push($("<li><img src='./img/ic_star_yellow.png'></li>"))
				}
				$(".pingfenOl").html(arr)
			}
			$("footer span").html(shuju.data.userSpecialistDetails.specialistMoney)
			$("footer").on("touchstart", function() {
				var oUserUrl = shuju.data.userSpecialistDetails.userUrl;
				var oUserName = shuju.data.userSpecialistDetails.userName;
				var oSpecialistMoney = shuju.data.userSpecialistDetails.specialistMoney;
				var zhiwei = shuju.data.userSpecialistDetails.specialistJobtitle
				var jiao = shuju.data.userSpecialistDetails.teacherType;
				var zhuan = shuju.data.userSpecialistDetails.userType;
				var urls = "yishengjiaoyu/xiZhuanTiwen.html?identity=" + identity + "&timestamp=" + timestamp;
				getPath(encodeURI(urls));
			})
		},
		error: function() {
			console.log("======= 服务器响应失败调用 ==========")
		},
		complete: function() {
			console.log("======== 请求完毕之后调用，注意：无论服务器响应成功与否，都会调用这个函数！！ ===========")
		}
	})
	console.log(identity)
			var shuju2 = {
				type: "4"
			}
			shuju2.id=identity;
	$("#sixin").on("touchstart", function(identity) {
		if($("#sixin").attr("class") == "btntxt2") {
			$.ajax({
				url: localhost() + "interactive/set_collection", //请求路径
				dataType: "json", //返回数据格式
				async: true, //是否是异步，默认是异步
				data : JSON.stringify(shuju2), //参数   //data : JSON.stringify(shuju)//有时候数据需要转换,
				type: "POST", //请求方式
				contentType: "application/json", //post请求数据格式
				beforeSend: function() {
					console.log("======== 请求之前调用 =========");
				},
				success: function(data) {
					console.log("========= 服务器响应成功调用 ==========");
					console.log(data)
					if(data.data == 1) {
						$("#sixin").val("私信");
						$("#sixin").removeClass("btntxt2");
						$("#sixin").addClass("btntxt1");
					}
				},
				error: function() {
					console.log("======= 服务器响应失败调用 ==========");
				},
				complete: function() {
					console.log("======== 请求完毕之后调用，注意：无论服务器响应成功与否，都会调用这个函数！！ ===========");
				}
			});
		} else {
			var urls = "yishengjiaoyu/messageHTML/message.html";
			getPath(urls);
		}
	});

});